<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bubble Sort Visualizer</title>
  <style>
    body {
  margin: 0;
  font-family: 'Courier New', monospace;
  background: #0f172a;
  color: #f8fafc;
}

header {
  background: #1e293b;
  color: white;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
}

.visualizer-container {
  display: grid;
  grid-template-columns: 1fr 420px;
  height: calc(100vh - 60px);
}

.array-container {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 40px;
}

.number-box {
  background: #1e293b;
  padding: 10px 15px;
  font-size: 1.5rem;
  border-radius: 8px;
  transition: transform 0.5s ease;
}

.number-box.compare {
  background: #facc15;
  color: #000;
}

.arrow-container {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 10px;
  height: 20px;
}

.arrow {
  width: 30px;
  text-align: center;
  visibility: hidden;
}

.arrow.active {
  visibility: visible;
  color: #facc15;
}

.controls {
  display: flex;
  gap: 0.5rem;
  margin-top: 20px;
}

.controls button {
  padding: 0.4rem 0.8rem;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

.code-area {
  background: #1e293b;
  padding: 1rem;
  overflow-y: auto;
  font-size: 14px;
  line-height: 1.6;
}

code span {
  display: block;
  padding-left: 0.5rem;
  transition: background 0.2s ease;
}

code span.highlight {
  background: rgba(34,197,94,0.3);
  border-left: 4px solid #22c55e;
}
.input-section {
  display: flex;
  gap: 0.5rem;
  justify-content: center;
  margin: 10px 0;
}

#arrayInput {
  padding: 5px;
  width: 60%;
  border-radius: 6px;
  border: 1px solid #334155;
  background: #0f172a;
  color: white;
}

#setArrayBtn {
  padding: 6px 10px;
  background: #3b82f6;
  border: none;
  color: white;
  border-radius: 6px;
  cursor: pointer;
}

.loop-vars {
  margin-top: 10px;
  font-size: 14px;
  text-align: center;
  color: #94a3b8;
}
  </style>
</head>
<body>
  <header>
    <h1>Bubble Sort</h1>
    <button class="back-btn" onclick="window.location.href='bubble-sort.html'">⬅ Back</button>
  </header>

  <main class="visualizer-container">
    <section class="animation-area">
      <div class="input-section">
        <input type="text" id="arrayInput" placeholder="Enter numbers separated by commas (e.g. 5,3,8)">
        <button id="setArrayBtn">Set Array</button>
      </div>

      <div class="array-container" id="array-container"></div>
      <div class="arrow-container" id="arrow-container"></div>

      <div class="loop-vars">
        <span id="i-value">i = 0</span> | <span id="j-value">j = 0</span>
      </div>

      <div class="controls">
        <button id="runBtn">▶ Run</button>
        <button id="pauseBtn">⏸ Pause</button>
        <button id="stepBtn">⏭ Next Step</button>
        <label>Speed: <input type="range" id="speedSlider" min="200" max="2000" step="100" value="1000"></label>
      </div>
    </section>
    <section class="code-area">
      <pre><code id="code-block">
<span data-line="1">function bubbleSort(arr) {</span>
<span data-line="2">  for (let i = 0; i < arr.length - 1; i++) {</span>
<span data-line="3">    for (let j = 0; j < arr.length - i - 1; j++) {</span>
<span data-line="4">      if (arr[j] > arr[j+1]) {</span>
<span data-line="5">        let temp = arr[j];</span>
<span data-line="6">        arr[j] = arr[j+1];</span>
<span data-line="7">        arr[j+1] = temp;</span>
<span data-line="8">      }</span>
<span data-line="9">    }</span>
<span data-line="10">  }</span>
<span data-line="11">  return arr;</span>
<span data-line="12">}</span>
      </code></pre>
    </section>
  </main>

  <script>
    const arrayContainer = document.getElementById("array-container");
const arrowContainer = document.getElementById("arrow-container");
const runBtn = document.getElementById("runBtn");
const stepBtn = document.getElementById("stepBtn");
const pauseBtn = document.getElementById("pauseBtn");
const setArrayBtn = document.getElementById("setArrayBtn");
const arrayInput = document.getElementById("arrayInput");
const iValue = document.getElementById("i-value");
const jValue = document.getElementById("j-value");

let arr = [5, 1, 4, 2, 8];
let i = 0, j = 0;
let interval;
let delay = 1000;

// Build UI
function createArrayUI() {
  arrayContainer.innerHTML = "";
  arrowContainer.innerHTML = "";
  arr.forEach(() => {
    const arrow = document.createElement("div");
    arrow.className = "arrow";
    arrow.innerHTML = "⬆";
    arrowContainer.appendChild(arrow);
  });

  arr.forEach(num => {
    const box = document.createElement("div");
    box.className = "number-box";
    box.innerText = num;
    arrayContainer.appendChild(box);
  });
  updateLoopVars();
}
createArrayUI();

function highlightLine(line) {
  document.querySelectorAll("code span").forEach(span => span.classList.remove("highlight"));
  document.querySelector(`code span[data-line="${line}"]`).classList.add("highlight");
}

function showComparison(a, b) {
  document.querySelectorAll(".number-box").forEach(box => box.classList.remove("compare"));
  document.querySelectorAll(".arrow").forEach(arrow => arrow.classList.remove("active"));

  const boxes = document.querySelectorAll(".number-box");
  const arrows = document.querySelectorAll(".arrow");

  boxes[a].classList.add("compare");
  boxes[b].classList.add("compare");
  arrows[a].classList.add("active");
  arrows[b].classList.add("active");
}

function swapUI(a, b) {
  const boxes = document.querySelectorAll(".number-box");
  const temp = boxes[a].innerText;
  boxes[a].innerText = boxes[b].innerText;
  boxes[b].innerText = temp;
}

function updateLoopVars() {
  iValue.innerText = `i = ${i}`;
  jValue.innerText = `j = ${j}`;
}

async function bubbleSortStep() {
  if (i < arr.length - 1) {
    if (j < arr.length - i - 1) {
      highlightLine(3);
      showComparison(j, j + 1);
      updateLoopVars();

      await new Promise(res => setTimeout(res, delay));

      highlightLine(4);
      if (arr[j] > arr[j + 1]) {
        highlightLine(5);
        await new Promise(res => setTimeout(res, delay / 2));

        [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
        swapUI(j, j + 1);
      }

      j++;
    } else {
      j = 0;
      i++;
    }
  } else {
    clearInterval(interval);
    highlightLine(11);
  }
}

runBtn.addEventListener("click", () => {
  clearInterval(interval);
  interval = setInterval(bubbleSortStep, delay * 1.5);
});

pauseBtn.addEventListener("click", () => clearInterval(interval));

stepBtn.addEventListener("click", bubbleSortStep);

speedSlider.addEventListener("input", (e) => {
  delay = parseInt(e.target.value);
});

setArrayBtn.addEventListener("click", () => {
  const values = arrayInput.value.split(",").map(v => parseInt(v.trim())).filter(v => !isNaN(v));
  if (values.length > 0) {
    arr = values;
    i = 0;
    j = 0;
    createArrayUI();
    clearInterval(interval);
    highlightLine(1);
  }
});
  </script>
</body>
</html>
